{% extends "base.html" %}
{% block body %}
<div class="container text-center mt-5">
    <h3 class="mb-3">Looking for a Partner...</h3>
    
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
    
    <p class="mt-4 text-muted lead">
        Please wait. We are finding a real player for <strong>{{ game|replace('_', ' ')|title }}</strong>.
    </p>
    <p class="small text-muted">Do not close this page.</p>
    
    <a href="{{ url_for('find_a_friend_hub') }}" class="btn btn-outline-secondary mt-3">Cancel</a>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
<script>
    const socket = io();
    const sessionId = {{ session_id }};
    const gameType = "{{ game }}";

    socket.on('connect', () => {
        // Join session room
        socket.emit('join_game', {session_id: sessionId});
    });

    // Wait for signal from server
    socket.on('match_found', (data) => {
        window.location.href = "/play/" + gameType;
    });
</script>
{% endblock %}